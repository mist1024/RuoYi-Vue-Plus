# 配餐功能说明
- 功能说明：
记录病患营养配餐会诊结果，并通过配餐页面设置在病患每日报餐的依据
- 数据结构
独立单表，记录病患营养配餐情况
* 数据说明
    病患id、正餐类型（早午晚，夜间加餐）、配餐号、配餐频次、用法、
    是否替代正餐、作废标志、更新日期、更新人
 * 对应创建营养配餐日志表，用于记录修改的历史情况
 - 界面设计
 1. 搜索栏：住院号、姓名、科室、床号、作废标志
 2. 功能栏： 添加、删除、作废、每日简报、记录表、拷贝并新增、拷贝、粘贴
 3. 数据栏：科室、姓名、床号、餐号、频次、用法、时间、更新人、早午晚、描述
 
 - 功能设计
 1. 新增会诊记录
 - 选择科室、找到病人
 - 选择餐号、用法
 - 多选早午晚加，自动生成频次，频次可以手动修改
 2. 拷贝并新增
 - 选择列表中某个记录
 - 选择“拷贝并新增”按钮
 - 选择列的数据填充到新增弹出层表格中
 - 操作员选择科室、病人，确认后，产生新营养配餐记录
 3. 拷贝功能
 - 选择列表中任意一个记录
 - 点击“拷贝”按钮后，按钮文字变成“批量粘贴”
 - 选择多个除拷贝的数据列病患记录外的其他病患记录
 - 点击“批量粘贴”，其他被选择的病患记录更新为拷贝列一样的营养配餐数据
 3. 作废按钮
 - 可以多选，多个病患营养配餐数据设置为作废状态，有需要的时候，可以恢复
 4. 签领单下载
 - 导出签领单格式的excel
 - 数据格式以病患为单位的单日统计表，列出空项目，用于签名
 - 统计项：餐数、单项汇总早午晚加的数据
 - 合计汇总； 总人数、餐数、科室分类统计
 - 可选择一周内多日导出
 
 # 收费结算功能
 1. 开票挂账
 - 列表所有已结算病患结算单
 - 列表后方设置快捷开票按钮，只针对当前结算单开票
 - 选择按钮“开票”，选择病人，列出该病患所有可开票结算单
 - 选择可多选对应的结算单，列出待开发票汇总金额
 点击“开票”
 - 输入单位信息、发票信息
 - 选择开票，记录开票信息
 - 选择挂账， 记录挂账信息
 2. 对应数据结构
 - id、发票单位、发票id、日期、开票人、收款方式、应收、实收、凭证列表
 3. 收费窗口日常收费
 - 选择病患信息
 - 输入结算日期、实收金额
 - 确认后，提示现金收款、在线支付
 3. 开票挂账逻辑
 - 功能说明；记录开票后收款的信息，并记录汇款情况和总体情况
 - 先开票后收款：单位、病患姓名、金额、对应的结算记录、应收、实收
 - 查看未收款情况
 - 记录回款情况：回款日期、金额、余额、凭证list
 - 确认后，更新发票收款状态、结算单状态
 4. 集体多人挂账方式
 - 功能说明：记录合作机构长期滚动结算的信息
 - 先新增合作单位
 - 为合作单位绑定结算相关的病患信息
 - 可以生成结算单（按月结算）
 - 结算挂账记录
 - 回款历史清单
 - 统计
 - 记录方式：用报餐表记录流水，结算单记录个人或多人的汇总
 - 数据格式：添加字段：个人/多人标志 多人list、收款方式：现金、在线支付、银行转账
 5. 操作
 - 选择合作单位
 - 列出该单位所有对象未结算金额
 - 可以对任意对象生成月结单或出院结算单
 - 汇总金额后，输入开票信息
 - 相关统计：历史发票、历史回款流水
  
# 前端：员工报餐
## 功能说明：
- 配置多种模式，适应不同的场景
    - 记账模式
        - 说明：
        针对公司包餐的形式，或者是，先记录后结算的模式，员工只需要报餐和用餐登记即可
    - 补贴模式
        - 说明：
        公司承担部分餐费，餐费以补贴形式发到员工账上，用于用餐消费
    - 销售模式
        - 说明：
        员工用餐完全自费，可在价格上优惠的模式，食堂独立经营
- 记账模式设计
    - 以仁爱为例
    - 界面设计
        - tabbar：首页、订单、个人、login
        - 首页
            - 第一栏：姓名、现在正在用餐、用餐时间、余额
            - 第二栏；当前订单
            - 第三栏；当前菜品
            - 第四栏；一周菜谱
            - 第五栏：订餐区
              - 一周日历
              - 早午晚复选框
              - 根据报餐模式显示：
                - 自动模式；停餐
                - 手动模式：报餐
         - 订单
            - 显示所有有效订单
            - 点击订单显示详情和二维码，下方有取消订单按钮
         - 个人
            - 显示个人信息
            - 余额信息
            - 当前订餐模式配置
            - 退出登录按钮
- 前端接口api清单：
  - 获取用餐时间；getDinnerTimeSetting
  - 获取当天订单详情；getOrderOfToday
  - 获取每周菜谱：getWeekMenu
  - 获取有效订单列表；getAvailableOrder
  - 发送订餐订单信息；PostOrder
  - 获取二维码：getQrcode
  - 获取当前订餐模式配置信息；getConfiguration
  - 更新当前配置：postConfiguration
  - 登录/登出：login / logout
  - 获取工作日/节假日信息：getWorkday / getHoliday
  - 获取菜品信息：getProduct
  - 获取其他商品信息：getOtherProduct
  - 生成购物订单；postProductOrder
  - 取消当前订单; postCurrentOrder
  - 请求停餐/恢复：postStopOrder / postRestoreOrder
  
- 后端：定时任务生成员工订餐逻辑
  - 系统配置表：
    - 数据库格式：id、企业id、config_key, config_value, flag
  - 记账模式有效
  - 取所有自动报餐并且当天没有停餐记录的员工，生成当天报餐订单记录
  - 分别生成早午晚
    
# 前端：护工报餐功能
## 功能说明
  - 优化：在数据表中增加订单详情描述，减少前端计算
## UI设计
  - tabbar：科室、报餐、个人
    - 科室：显示科室清单，首选本人负责的科室
    - 报餐：列表方式显示：床号、姓名、订餐描述、营养配餐
     - 显示个人：早午晚加餐的明细
     - 快捷按钮：全天停餐、变更
    - 个人：姓名、公司、报餐科室、退出登录
  - 报餐操作
    - 选择正餐类型，复选框，可以考虑增加早午晚类型的过滤，减少显示类型
    - 选择加餐开关
    - 选择加蛋数量
    - 功能按钮
      - 更新
      - 停餐
      - 记住修改
  
 
 ## 问题记录
 1. 营养配餐每小时频次怎么回事
 2. 了解残联这种长期合作的结算方式怎样
 3. 营养配餐记录表的要求
 4. 营养配餐替代正餐逻辑，如果替代的话， 护工是应该无权修改正餐报餐
