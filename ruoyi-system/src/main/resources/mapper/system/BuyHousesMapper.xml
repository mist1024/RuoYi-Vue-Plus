<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.BuyHousesMapper">

    <resultMap type="com.ruoyi.system.domain.BuyHouses" id="BuyHousesResult">
        <result property="id" column="id"/>
        <result property="insidepageUrl" column="insidepage_url"/>
        <result property="cardId" column="card_id"/>
        <result property="commitmentUrl" column="commitment_url"/>
        <result property="companyAddress" column="company_address"/>
        <result property="companyName" column="company_name"/>
        <result property="createTime" column="create_time"/>
        <result property="declarationUrl" column="declaration_url"/>
        <result property="district" column="district"/>
        <result property="education" column="education"/>
        <result property="frontUrl" column="front_url"/>
        <result property="gyStatus" column="gy_status"/>
        <result property="homeRecordUrl" column="home_record_url"/>
        <result property="homepageUrl" column="homepage_url"/>
        <result property="laborContractUrl" column="labor_contract_url"/>
        <result property="licenseUrl" column="license_url"/>
        <result property="maritalStatus" column="marital_status"/>
        <result property="maritalUrl" column="marital_url"/>
        <result property="nationality" column="nationality"/>
        <result property="phone" column="phone"/>
        <result property="qyStatus" column="qy_status"/>
        <result property="reverseUrl" column="reverse_url"/>
        <result property="sex" column="sex"/>
        <result property="shStatus" column="sh_status"/>
        <result property="socialCode" column="social_code"/>
        <result property="socialSecurityUrl" column="social_security_url"/>
        <result property="status" column="status"/>
        <result property="type" column="type"/>
        <result property="userId" column="user_id"/>
        <result property="userName" column="user_name"/>
        <result property="passTime" column="pass_time"/>
        <result property="pictureInformationUrl" column="picture_information_url"/>
        <result property="workAddress" column="work_address"/>
        <result property="updateTime" column="update_time"/>
        <result property="processKey" column="process_key"/>
        <result property="processStatus" column="process_status"/>
        <result property="version" column="version"/>
        <result property="apiKey" column="api_key"/>
        <result property="step" column="step"/>

    </resultMap>
    <select id="getIndexType" resultType="java.util.Map">
        SELECT type as 'name',COUNT(type) AS 'value' FROM `buy_houses` WHERE process_status = 5 GROUP BY type ORDER BY type
    </select>
    <select id="getActProcessList" resultType="java.util.Map">
        SELECT (
                   CASE WHEN step='1' THEN '受理中'
                        WHEN step ='2' THEN '初审中'
                        WHEN step = '3' THEN '审定中'
                        ELSE '' END) AS `name`, COUNT(step) AS 'value' FROM act_process WHERE process_id IN(SELECT id FROM `process` WHERE process_key = 'apply_house') GROUP BY step;
    </select>
    <select id="getCompanyDistrict" resultType="java.util.Map">
        SELECT (
                   CASE WHEN district='1' THEN '数字经济局'
                        WHEN district = '3' THEN '高新西区'
                        WHEN district = '4' THEN '生物城'
                        WHEN district ='2' THEN '交子公园金融商务区'
                        ELSE '' END) AS `name`,COUNT(DISTINCT company_name,district) AS 'value' FROM buy_houses WHERE process_status = 5 GROUP BY district
    </select>
    <select id="getNationality" resultType="java.util.Map">
        SELECT nationality as 'name',COUNT(nationality) AS 'value' FROM buy_houses WHERE process_status=5 GROUP BY nationality;
    </select>
    <select id="getMaritalStatus" resultType="java.util.Map">
        SELECT (
                   CASE WHEN marital_status='1' THEN '未婚'
                        WHEN marital_status ='2' THEN '已婚'
                        WHEN marital_status = '3' THEN '离异'
                        ELSE '' END)  as 'name',COUNT(marital_status) AS 'value' FROM buy_houses WHERE process_status=5 GROUP BY marital_status;
    </select>


</mapper>
